<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Air Quality Invisible Cities</title>
    <!-- Required meta tags -->
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">

    <!-- Material Kit CSS -->
    <link href="assets/css/material-kit.css?v=2.0.5" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js" integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg==" crossorigin=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--FULLPAGE-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="assets/libs/lethargy.min.js"></script>
    <script src="https://rawgit.com/Olical/EventEmitter/master/EventEmitter.min.js"></script>
    <script src="assets/libs/smartscroll.min.js"></script>

    <!-- Leaflet plugins & stuff -->
    <script src="assets/libs/leaflet-svg-shape-markers.min.js"></script>
    <script src="assets/js/leaflet_functions.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
    <script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>

    <!-- Data-->
    <script src="assets/js/countries.js"></script>

</head>
<body>
<div class="header">
    <nav class="navbar navbar-color-on-scroll navbar-transparent fixed-top navbar-expand-lg" style="padding-top: 5px;" color-on-scroll="100">
<!--        <div class="container">-->
<!--            <div class="navbar-translate">-->
<!--                <a class="navbar-brand" href="http://aqicn.org/map/#@g/7.7002/59.0625/2z">-->
<!--                    More About AQI </a>-->
<!--                <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">-->
<!--                    <span class="sr-only">Toggle navigation</span>-->
<!--                    <span class="navbar-toggler-icon"></span>-->
<!--                    <span class="navbar-toggler-icon"></span>-->
<!--                    <span class="navbar-toggler-icon"></span>-->
<!--                </button>-->
<!--            </div>-->
            <!--NAVIGATION TABS-->
            <div class="collapse navbar-collapse">
                <ul id="menu" >
                    <li data-menuanchor="page1" class="active"><a href="#page1" title="Top"><img src="assets/img/homepage.png"></a></li>
                    <li data-menuanchor="page2"><a href="#page2" title="Globe Map"><img src="assets/img/globe.png"></a></li>
                    <li data-menuanchor="page3"><a href="#page3" title="2D Map"><img src="assets/img/statistics.png"></a></li>
                    <li data-menuanchor="page4"><a href="#page4" title="Street Map"><img src="assets/img/street.png"></a></li>
                    <li data-menuanchor="page4"><a href="#page4" title="About"><img src="assets/img/info-button.png"></a></li>
                </ul>
            </div>
    </nav>
</div>
<div class="section-wrapper">
    <div id="page1" class="section"style="padding: 0px 0" data-hash="a">
            <div class="page-header header-filter" data-parallax="true" style="background-image: url('assets/img/cover-02.jpg')">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8 ml-auto mr-auto">
                            <div class="brand text-center">
                                <h1>Invisible Cities</h1>
                                <h3 class="title text-center">World City Air Quality</h3>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
    </div>
    <div id="page2" style="height: 100vh; padding: 0px 0;" class="section" data-hash="b">
        <iframe id="globe" src="globe/globe.html" height="100%" width="100%" frameBorder="10px" scrolling="no"></iframe>
    </div>

    <div id="page3" class="section" style="height: 100vh; padding: 0px 0;" data-hash="c">
        <div id="map" style="height: 100vh; margin-top: 0;"></div>

        <script>
            // script for initalising th map
            // set max bounds
            var bounds = L.latLngBounds(L.latLng(-90.0, 180.227), L.latLng(90.0, -180.125));
            var mymap = L.map('map', {maxBounds:bounds}).setView([34, 24], 2);

            mymap.options.minZoom = 2;
            mymap.options.maxZoom = 10;
            mymap.doubleClickZoom.disable(); // disable double click zoom (as double click is used to rebound the map to a country in updateMap.js)

            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidWN6bHFqdSIsImEiOiJjam4zOXRjMHUwY3htM3BteXgxazVxZ3QzIn0.mmRn_HjpXDzMJrKj1apGNQ', {
                maxZoom: 18,
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                id: 'mapbox.dark'
            }).addTo(mymap);

            mymap.scrollWheelZoom.disable();

            // click to zoom
            mymap.on('dblclick', function() {
                if (mymap.scrollWheelZoom.enabled()) {
                    mymap.scrollWheelZoom.disable();
                }
                else {
                    mymap.scrollWheelZoom.enable();
                }
            });

            var quantileView = [];

            // from https://github.com/CliffCloud/Leaflet.EasyButton
            L.easyButton({
                states: [{
                    stateName: 'unchecked',        // name the state
                    icon:      '&#919',               // and define its properties
                    title:     'High Industrial (Unchecked)',      // like its title
                    onClick: function(btn, map) {       // and its callback
                        var index = quantileView.indexOf(3);

                        if (index > -1) {
                            quantileView.splice(index, 1);
                            loadAirQualityData(quantileView);
                        } else {
                            quantileView.push(3)
                            loadAirQualityData(quantileView);
                        }
                        btn.state('checked');
                    }
                }, {
                    stateName: 'checked',
                    icon:      'fa-check',
                    title:     'High Industrial (Checked)',
                    onClick: function(btn, map) {
                        var index = quantileView.indexOf(3);

                        if (index > -1) {
                            quantileView.splice(index, 1);
                            loadAirQualityData(quantileView);
                        } else {
                            quantileView.push(3)
                            loadAirQualityData(quantileView);
                        }
                        btn.state('unchecked');
                    }
                }]

            }).addTo(mymap);

            L.easyButton({
                states: [{
                    stateName: 'unchecked',        // name the state
                    icon:      '&#x0039C;',               // and define its properties
                    title:     'Middle Industrial (Unchecked)',      // like its title
                    onClick: function(btn, map) {       // and its callback
                        var index = quantileView.indexOf(2);

                        if (index > -1) {
                            quantileView.splice(index, 1);
                            loadAirQualityData(quantileView);
                        } else {
                            quantileView.push(2)
                            loadAirQualityData(quantileView);
                        }
                        btn.state('checked');
                    }
                }, {
                    stateName: 'checked',
                    icon:      'fa-check',
                    title:     'Middle Industrial (Checked)',
                    onClick: function(btn, map) {
                        var index = quantileView.indexOf(2);

                        if (index > -1) {
                            quantileView.splice(index, 1);
                            loadAirQualityData(quantileView);
                        } else {
                            quantileView.push(2)
                            loadAirQualityData(quantileView);
                        }
                        btn.state('unchecked');
                    }
                }]
            }).addTo(mymap);

            L.easyButton({
                states: [{
                    stateName: 'unchecked',        // name the state
                    icon:      '&#x00139;',               // and define its properties
                    title:     'Low Industrial (Unchecked)',      // like its title
                    onClick: function(btn, map) {       // and its callback
                        var index = quantileView.indexOf(1);

                        if (index > -1) {
                            quantileView.splice(index, 1);
                            loadAirQualityData(quantileView);
                        } else {
                            quantileView.push(1)
                            loadAirQualityData(quantileView);
                        }
                        btn.state('checked');
                    }
                }, {
                    stateName: 'checked',
                    icon:      'fa-check',
                    title:     'Low Industrial (Checked)',
                    onClick: function(btn, map) {
                        var index = quantileView.indexOf(1);

                        if (index > -1) {
                            quantileView.splice(index, 1);
                            loadAirQualityData(quantileView);
                        } else {
                            quantileView.push(1)
                            loadAirQualityData(quantileView);
                        }
                        btn.state('unchecked');
                    }
                }]
            }).addTo(mymap);

            // TODO add check button for easy Buttons
            loadAirQualityData(quantileView); // load air quality quantile

        </script>
    </div>
    <div id="page4" class="section" style="height: 100vh; padding: 0px 0;" data-hash="d">
        Street-level visualisation
    </div>
    <div id="page5" class="section" style="height: 100vh; padding: 0px 0;" data-hash="d">
        About
    </div>
</div>
<div class="footer">
    <div>
        <p>This section is not inside the section wrapper, so normal scrolling here!</p>
    </div>
</div>

<script>
    var ee = new EventEmitter();
    $.smartscroll({
        mode: "set",
        eventEmitter: ee,
        // initialScroll: true,
        sectionScroll: true
    });

</script>

</body>
</html>